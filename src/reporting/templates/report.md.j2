# Security Incident Report

**Report ID:** {{ report_id }}
**Generated:** {{ generated_at }}
**PCAP File:** {{ pcap_file }}
**Risk Level:** {{ risk_level }} (Score: {{ risk_score }}/100)

---

## Executive Summary

Analysis of the network capture identified **{{ total_findings }} security findings** across {{ total_packets | default(0) }} packets ({{ total_bytes_formatted }}).

{% if critical_count > 0 %}
**{{ critical_count }} CRITICAL finding(s) require immediate attention.**
{% endif %}
{% if high_count > 0 %}
{{ high_count }} HIGH severity finding(s) should be addressed promptly.
{% endif %}

---

## Overview Statistics

| Metric | Value |
|--------|-------|
| Total Packets | {{ "{:,}".format(total_packets) }} |
| Total Bytes | {{ total_bytes_formatted }} |
| Capture Duration | {{ capture_duration }} seconds |
| Unique IPs | {{ unique_ips }} |
| Unique Ports | {{ unique_ports }} |
| Analysis Duration | {{ analysis_duration }} seconds |

---

## Findings Summary

| Severity | Count |
|----------|-------|
| Critical | {{ critical_count }} |
| High | {{ high_count }} |
| Medium | {{ medium_count }} |
| Low | {{ low_count }} |
| **Total** | **{{ total_findings }}** |

---

## Detailed Findings

{% for severity in ['critical', 'high', 'medium', 'low'] %}
{% set findings_list = findings_by_severity[severity] %}
{% if findings_list %}
### {{ severity | upper }} Severity

{% for finding in findings_list %}
#### {{ loop.index }}. {{ finding.title }}

**Category:** {{ finding.category }}
{% if finding.mitre_technique %}**MITRE ATT&CK:** {{ finding.mitre_technique }}{% endif %}

{{ finding.description }}

{% if finding.source_ip %}- **Source IP:** {{ finding.source_ip }}{% endif %}
{% if finding.destination_ip %}- **Destination IP:** {{ finding.destination_ip }}{% endif %}
{% if finding.destination_port %}- **Port:** {{ finding.destination_port }}{% endif %}

{% if finding.evidence %}
**Evidence:**
{% for ev in finding.evidence %}- {{ ev }}
{% endfor %}{% endif %}

{% if finding.recommendations %}
**Recommendations:**
{% for rec in finding.recommendations %}- {{ rec }}
{% endfor %}{% endif %}

---

{% endfor %}
{% endif %}
{% endfor %}

## Indicators of Compromise (IOCs)

{% if malicious_ips %}
### Suspicious IP Addresses

```
{% for ip in malicious_ips[:30] %}{{ ip }}
{% endfor %}{% if malicious_ips | length > 30 %}... and {{ malicious_ips | length - 30 }} more{% endif %}
```
{% endif %}

{% if malicious_domains %}
### Suspicious Domains

```
{% for domain in malicious_domains[:30] %}{{ domain }}
{% endfor %}{% if malicious_domains | length > 30 %}... and {{ malicious_domains | length - 30 }} more{% endif %}
```
{% endif %}

{% if suspicious_ports %}
### Suspicious Ports

{{ suspicious_ports | join(', ') }}
{% endif %}

---

{% if mitre_coverage %}
## MITRE ATT&CK Coverage

{% for tactic, techniques in mitre_coverage.items() %}
### {{ tactic }}

{% for tech in techniques %}- **{{ tech.technique_id }}**: {{ tech.name }}
{% endfor %}
{% endfor %}
{% endif %}

---

{% if timeline %}
## Event Timeline

| Time | Event | Severity |
|------|-------|----------|
{% for event in timeline[:50] %}| {{ event.time_formatted | default('N/A') }} | {{ event.title | default('Unknown') }} | {{ event.severity | default('N/A') }} |
{% endfor %}
{% endif %}

---

{% if recommendations %}
## Recommendations

{% for rec in recommendations %}{{ loop.index }}. {{ rec }}
{% endfor %}
{% endif %}

---

*Generated by SOC PCAP Analyzer*